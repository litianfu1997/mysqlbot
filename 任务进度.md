# MySqlBot 开发进度

## 总体目标
开发一个基于 LLM 的 Text-to-SQL 智能数据问答助手，对标 SQLBot，具备企业级的数据分析与可视化能力。

## ✅ 后端开发 (Backend) - [已完成]

### 1. 核心引擎 (Core Engine)
- [x] **SpringBoot 架构**: 集成 Spring AI (DeepSeek/OpenAI), Spring Data JPA, PgVector。
- [x] **多数据源管理**: 支持动态连接 MySQL/PostgreSQL 目标数据库。
- [x] **RAG 向量检索**:
  - 自动提取表结构 (Schema) 并向量化。
  - 支持语义检索最相关的表和字段。
- [x] **SQL 生成 (Text-to-SQL)**: 
  - 基于 `template.yaml` 深度优化 Prompt 结构与规则。
  - 强制 Schema 全路径引用，支持 JSON 结构化输出解析。
- [x] **自愈重试机制**: SQL 执行失败自动反馈错误并引导模型修正，提升容错率。
- [x] **SQL 安全执行**: 
  - JSqlParser 语法校验 (仅允许 SELECT)。
  - 执行超时与最大行数限制。

### 2. 智能增强 (Intelligence) - [已完成]
- [x] **Few-Shot 增强生成**: 
  - 支持 SQL 案例库管理。
  - 生成 SQL 时自动检索相似的历史案例作为参考 (Few-Shot RAG)。
- [x] **RAG 算法改进**:
  - 动态调整相似度阈值 (0.5 -> 0.3)，提升小样本召回率。
  - 为 MySQL 强制注入 Database 前缀，解决跨库定位问题。
- [x] **智能数据分析**:
  - `DataAnalysisService`: 自动对查询结果进行总结，生成业务洞察 (Insights)。
- [x] **图表推荐**:
  - 智能判断适合的图表类型 (Bar/Line/Pie/Table)。
  - 自动映射 X 轴和 Y 轴字段。
- [x] **猜你喜欢 (Follow-up Questions)**:
  - `SuggestQuestionService`: 基于当前上下文，生成 3 个引导式后续问题。

### 3. 企业级特性 (Enterprise Features) - [已完成]
- [x] **行级权限控制 (Row-Level Security)**: 
  - `SqlPermissionService`: LLM 驱动的 SQL 重写管道，强制应用数据过滤规则 (e.g., `dept_id=1001`)。
- [x] **动态配置**: 
  - `AppConfig`: 支持运行时调整 LLM 模型、Temperature、SQL 限制参数。
- [x] **会话管理**: 完整的对话历史记录与上下文维护。

## ✅ 前端开发 (Frontend) - [已完成]

### 1. 基础框架建设
- [x] 初始化 Vue 3 + Vite + TypeScript 项目。
- [x] 集成 Element Plus (UI 库) 和 TailwindCSS (原子类样式 - used simulated utilities)。
- [x] 封装 Axios 请求与 Pinia 状态管理。

### 2. 核心功能实现
- [x] **数据源管理**: 侧边栏及弹窗式数据源选择，支持后端同步。
- [x] **智能对话终端 (Chat Interface)**:
    - [x] 类似 ChatGPT 的流式交互体验。
    - [x] 消息卡片组件: 用户提问、Markdown 渲染、SQL 代码高亮。
    - [x] 智能表格展示：自动渲染查询结果集。
- [x] **数据可视化**:
    - [x] 集成 ECharts 全局注册。
    - [x] **智能图表渲染**: 自动根据 API 返回的 `chartType` (Bar/Line/Pie) 渲染可视化图表，无需手动配置。
- [x] **智能分析与引导**:
    - [x] 分析卡片: 展示 LLM 生成的 "数据洞察" (Insight)。
    - [x] 推荐问题: 底部展示 "猜你喜欢" 气泡，点击即查。

### 3. 设置与维护
- [ ] 知识库管理 (业务术语、SQL 案例) - *Pending Implementation*
- [ ] 系统配置面板 (模型切换) - *Backend Ready, Frontend UI Pending*

## 📅 下一步计划 (Next Steps)
1. 完善前端的系统设置页面，允许用户在界面上切换 LLM 模型。
2. 添加更多图表类型支持 (如 Scatter, Area)。
3. 开发知识库管理界面，允许用户上传业务术语和 SQL 案例。
4. 增强移动端适配。

---
*更新时间: 2026-02-19*
